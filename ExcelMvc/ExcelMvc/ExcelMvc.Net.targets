<Project>
	<Target Name="ExcelMvc" AfterTargets="Build" Condition="'$(ExcelMvcAddInName)' != ''" >
		<Copy SourceFiles="$(MSBuildThisFileDirectory)ExcelMvc.Addin.x86.xll"
			  DestinationFiles ="$(TargetDir)$(ExcelMvcAddInName).xll">
		</Copy>
		<Copy SourceFiles="$(MSBuildThisFileDirectory)ExcelMvc.Addin.x64.xll"
			  DestinationFiles ="$(TargetDir)$(ExcelMvcAddInName)64.xll">
		</Copy>
		<Copy SourceFiles="$(MSBuildThisFileDirectory)ExcelMvc.reflection.txt"
			  DestinationFiles ="$(TargetDir)ExcelMvc.reflection.txt">
		</Copy>
		<Copy Condition="'$(TargetFramework.EndsWith(`-windows`))' == 'true'"
			  SourceFiles="$(MSBuildThisFileDirectory)ExcelMvc.runtimeconfig.json"
		      DestinationFiles="$(TargetDir)ExcelMvc.runtimeconfig.json">
		</Copy>
		<Copy Condition="'$(TargetFramework.EndsWith(`-windows`))' == 'true'"
			  SourceFiles="$(MSBuildThisFileDirectory)ExcelMvc.runtimeconfig.json"
		      DestinationFiles="$(TargetDir)ExcelMvc.runtimeconfig.json">
		</Copy>
		<Exec Command="powershell -Execution Unrestricted -File &quot;$(MSBuildThisFileDirectory)ExcelMvc.reflection.ps1&quot; -TargetPath  &quot;$(TargetDir)\&quot;" />
	</Target>
	<Target Name="ExcelMvc" AfterTargets="Build" Condition="'$(ExcelMvcAddInName)' == ''" >
		<Delete Files="$(TargetDir)ExcelMvc.dll" />
		<Delete Files="$(TargetDir)Function.Interfaces.dll" />
	</Target>
</Project>